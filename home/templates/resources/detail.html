{% extends "layouts/base.html" %}
{% load static %}

{% block title %}{{ object.title }} ‚Äì Resource{% endblock %}

{% block content %}
<section class="container py-5">

  <nav class="mb-3">
    <a class="btn btn-sm btn-outline-secondary" href="{% url 'resources' %}">‚Üê Back to Library</a>
  </nav>

  <article class="row g-4 align-items-start">
    <!-- Media -->
    <div class="col-12 col-lg-5">
      <div class="hh-card">
        {% if object.cover %}
          <img src="{{ object.cover.url }}" alt="{{ object.title }}"
               style="width:100%; height:auto; display:block; border-radius: var(--radius-lg, 22px);">
        {% else %}
          <div class="hh-card-placeholder"
               style="height:260px; display:grid; place-items:center; border-radius: var(--radius-lg, 22px); color:var(--muted);">
            {{ object.get_category_display }}
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Meta / actions -->
    <div class="col-12 col-lg-7">
      <h1 class="fw-bold" style="color:var(--ink); margin-bottom:.25rem;">{{ object.title }}</h1>
      <div class="mb-2">
        <span class="hh-badge">{{ object.get_category_display }}</span>
        <span class="hh-meta">‚Ä¢ {{ object.file.size|filesizeformat }}</span>
        <span class="hh-meta">‚Ä¢ {{ object.published_at|date:"d M Y" }}</span>
      </div>

      {% if object.summary %}
        <p class="lead" style="color:var(--muted)">{{ object.summary }}</p>
      {% endif %}

      <div class="d-flex flex-wrap gap-2 mt-3">
       <a href="{{ object.file.url }}" target="_blank" rel="noopener noreferrer" class="btn btn-warning">üëÅ View in new tab</a>
       <a href="{% url 'resource_download' object.pk %}" class="btn btn-outline-secondary">‚¨á Download</a>
       <a href="{{ r.file.url }}" target="_blank" rel="noopener noreferrer" class="btn res-cta res-cta--primary">üëÅ View</a>

      </div>
    </div>
  </article>

  {% if object.file.url|lower|endswith:'.pdf' %}
    <div class="mt-4 hh-card p-2">
      <iframe
        src="{{ object.file.url }}#toolbar=0&navpanes=0&view=FitH"
        style="width:100%; height:78vh; border:0; border-radius:var(--radius); background:var(--card-2)"
        title="{{ object.title }} preview"
      ></iframe>
    </div>
  {% endif %}
</section>

<style>
.hh-card{
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg, 22px);
  box-shadow: var(--shadow, 0 10px 30px rgba(3,7,18,.08));
}
.hh-badge{
  display:inline-block; font-size:.75rem; padding:.25rem .6rem; border-radius:999px;
  background: color-mix(in oklab, var(--accent) 20%, transparent);
  border: 1px solid var(--accent);
  color: var(--ink);
}
.hh-meta{ color: var(--muted); font-weight:600; margin-left:.35rem; }
</style>
{% endblock %}
