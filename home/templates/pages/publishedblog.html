{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}
<main>
<section class="section section-lg">
  <div class="container">
    <h4 class="mb-4">Published Blogs</h4>

    <div class="row justify-content-center">
      {% for blog in blogpages %}
        <div class="col-md-8 mb-4">
          <div class="card" style="width: 100%; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-radius: 10px;">
            <div class="card-body">
              <div style="margin-bottom: 10px;">
                <h6 class="mb-0">{{ blog.name }}</h6>
                <small class="text-muted">{{ blog.created_at|date:"F d, Y" }}</small>
              </div>

              {% if blog.file %}
                <img src="data:image/jpeg;base64,{{ blog.file }}" style="width: 100%; border-radius: 10px; margin-bottom: 10px; object-fit: cover;" alt="Blog Image">
              {% endif %}

              <h5>{{ blog.title }}</h5>
              <p>{{ blog.description }}</p>

              <div style="display: flex; align-items: center;">
                <button class="btn btn-outline-primary btn-sm like-btn" onclick="toggleLike(this)">
                  ❤️ Like (<span class="like-count">0</span>)
                </button>
              </div>

            </div>
          </div>
        </div>
      {% empty %}
        <p>No blogs have been published yet.</p>
      {% endfor %}
    </div>

  </div>
</section>
</main>

<script>
function toggleLike(button) {
  let countSpan = button.querySelector('.like-count');
  let currentLikes = parseInt(countSpan.textContent);

  if (button.classList.contains('liked')) {
    // Unlike
    currentLikes -= 1;
    button.classList.remove('liked');
    button.classList.remove('btn-danger');
    button.classList.add('btn-outline-primary');
  } else {
    // Like
    currentLikes += 1;
    button.classList.add('liked');
    button.classList.remove('btn-outline-primary');
    button.classList.add('btn-danger');
  }

  countSpan.textContent = currentLikes;
}
</script>
{% endblock %}