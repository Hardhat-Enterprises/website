{% extends 'layouts/base.html' %} {% load static %} {% block content %}

<main>
    <section style="background-color:#ffc107; padding:6rem 0 4rem;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">

                    <!-- Card -->
                    <div class="card shadow-sm p-4 rounded-4" style="background:#fff;">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h3 class="fw-bold m-0">Cyber Achievements</h3>
                            <div class="small text-secondary">
                                <span class="me-3"><span class="legend-dot dot-earned"></span> Earned</span>
                                <span class="me-3"><span class="legend-dot dot-started"></span> Started</span>
                                <span><span class="legend-dot dot-locked"></span> Locked</span>
                            </div>
                        </div>

                        <!-- Progress -->
                        <div class="mb-3 d-flex justify-content-between">
                            <span class="fw-semibold">Overall Progress</span>
                            <span class="fw-semibold">
                {{ percent }}%
                {% if total_challenges %}
                  <span class="text-secondary fw-normal ms-2">
                    ({{ total_completed }}/{{ total_challenges }})
                  </span> {% endif %}
                            </span>
                        </div>
                        <div class="progress mb-4" style="height:12px; border-radius:50px;">
                            <div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="{{ percent }}" style="width: {{ percent }}%; border-radius:50px;">
                            </div>
                        </div>

                        <!-- Pills -->
                        <div class="d-flex flex-wrap gap-3">
                            {% for c in categories %} {% if c.status == "locked" %}
                            <div class="pill locked">
                                <span class="pill-text">{{ c.name }}</span>
                                <span class="pill-state">Locked</span>
                            </div>
                            {% else %}
                            <a href="{% url 'category_challenges' c.raw %}" class="text-decoration-none">
                                <div class="pill {{ c.status }}">
                                    <span class="pill-text">{{ c.name }}</span>
                                    <span class="pill-state">
                        {% if c.status == "earned" %}Earned{% else %}Started{% endif %}
                      </span>
                                </div>
                            </a>
                            {% endif %} {% empty %}
                            <div class="text-muted">No challenges found yet.</div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Back button -->
                    <div class="text-center mt-5">
                        <a href="{% url 'malware_viz_main' %}" class="btn btn-dark">
              ⬅️ Back to Cyber Challenges
            </a>
                    </div>

                </div>
            </div>
        </div>
    </section>
</main>

<style>
    .legend-dot {
        display: inline-block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-right: 6px;
    }
    
    .dot-earned {
        background: #38a169;
    }
    
    .dot-started {
        background: #cbd5e0;
    }
    
    .dot-locked {
        background: #2d3748;
    }
    
    .pill {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 14px;
        border-radius: 999px;
        min-width: 160px;
        font-weight: 600;
        font-size: 0.9rem;
        transition: transform 0.15s ease;
    }
    
    .pill-text {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .pill-state {
        margin-left: auto;
        font-size: 12px;
        font-weight: 700;
        padding: 4px 8px;
        border-radius: 20px;
    }
    /* Locked = dark background, white text (not clickable) */
    
    .pill.locked {
        background: #2d3748;
        color: #fff;
        cursor: default;
    }
    
    .pill.locked .pill-text {
        color: #fff;
    }
    
    .pill.locked .pill-state {
        background: rgba(255, 255, 255, .2);
        color: #fff;
    }
    /* Started = white background, grey text (clickable) */
    
    .pill.started {
        background: #fff;
        border: 1px solid #e2e8f0;
        color: #64748b;
        cursor: pointer;
    }
    
    .pill.started .pill-text {
        color: #64748b;
    }
    
    .pill.started .pill-state {
        background: #eef2f6;
        color: #64748b;
    }
    /* Earned = green background, white text (clickable) */
    
    .pill.earned {
        background: #38a169;
        color: #fff;
        cursor: pointer;
    }
    
    .pill.earned .pill-text {
        color: #fff;
    }
    
    .pill.earned .pill-state {
        background: rgba(255, 255, 255, .2);
        color: #fff;
    }
    /* Hover effect only for clickable ones */
    
    a.text-decoration-none:hover .pill.started,
    a.text-decoration-none:hover .pill.earned {
        transform: translateY(-2px);
    }
</style>

{% endblock content %}